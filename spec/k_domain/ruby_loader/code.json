[
  {
    "class_name": "Activity",
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      },
      {
        "name": "contact",
        "opts": {
        },
        "block": null
      },
      {
        "name": "company",
        "opts": {
        },
        "block": null
      },
      {
        "name": "estimate",
        "opts": {
        },
        "block": null
      },
      {
        "name": "invoice",
        "opts": {
        },
        "block": null
      },
      {
        "name": "order",
        "opts": {
        },
        "block": null
      },
      {
        "name": "sale",
        "opts": {
        },
        "block": null
      },
      {
        "name": "phone_call",
        "opts": {
        },
        "block": null
      },
      {
        "name": "task",
        "opts": {
        },
        "block": null
      },
      {
        "name": "email",
        "opts": {
        },
        "block": null
      },
      {
        "name": "comment",
        "opts": {
        },
        "block": null
      },
      {
        "name": "tracker",
        "opts": {
        },
        "block": null
      },
      {
        "name": "note",
        "opts": {
        },
        "block": null
      },
      {
        "name": "shipment",
        "opts": {
        },
        "block": null
      },
      {
        "name": "campaign",
        "opts": {
        },
        "block": null
      },
      {
        "name": "campaign_message",
        "opts": {
        },
        "block": null
      },
      {
        "name": "portal_comment",
        "opts": {
        },
        "block": null
      },
      {
        "name": "comment",
        "opts": {
        },
        "block": null
      },
      {
        "name": "inquiry",
        "opts": {
        },
        "block": null
      }
    ],
    "default_scope": {
      "block": "{ where(hide: false, deleted: false).order(\"activities.source_created_at DESC NULLS LAST\") }"
    },
    "before_create": [
      {
        "name": "update_source_created_at"
      }
    ],
    "before_save": [
      {
        "name": "update_source_created_at"
      }
    ],
    "after_create": [
      {
        "name": "update_last_contact"
      }
    ],
    "after_save": [
      {
        "name": "update_last_contact"
      }
    ]
  },
  {
    "class_name": "Address",
    "default_scope": {
      "block": "{ where(deleted: false) }"
    },
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      },
      {
        "name": "company",
        "opts": {
        },
        "block": null
      }
    ]
  },
  {
    "class_name": "Adjustment",
    "default_scope": {
      "block": "{ where(affect_sales: true, deleted: false, voided: false) }"
    },
    "scopes": [
      {
        "name": "for_dates",
        "opts": {
        },
        "block": "->(start_date, end_date) { where(posted_date: start_date..end_date) }"
      },
      {
        "name": "non_closed_out",
        "opts": {
        },
        "block": "-> { where(accounting_month: nil) }"
      }
    ],
    "belongs_to": [
      {
        "name": "invoice",
        "opts": {
        },
        "block": null
      },
      {
        "name": "company",
        "opts": {
        },
        "block": null
      },
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      },
      {
        "name": "user",
        "opts": {
          "class_name": "User",
          "foreign_key": "id",
          "primary_key": "sales_rep_user_id"
        },
        "block": null
      },
      {
        "name": "location",
        "opts": {
          "class_name": "Location",
          "foreign_key": "id",
          "primary_key": "location_user_id"
        },
        "block": null
      }
    ]
  },
  {
    "class_name": "ApiLog",
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      },
      {
        "name": "context",
        "opts": {
          "polymorphic": true
        },
        "block": null
      },
      {
        "name": "user",
        "opts": {
        },
        "block": null
      }
    ]
  },
  {
    "class_name": "Asset",
    "attr_accessor": [
      "file",
      "new_file_contents",
      "new_file_name"
    ],
    "before_save": [
      {
        "name": "upload_to_s3"
      }
    ],
    "after_destroy": [
      {
        "name": "remove_from_s3",
        "block": null
      }
    ],
    "belongs_to": [
      {
        "name": "enterprise",
        "opts": {
        },
        "block": null
      },
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      }
    ],
    "default_scope": {
      "block": "{ where.not(file_hash: nil) }"
    },
    "scopes": [
      {
        "name": "by_tenant",
        "opts": {
        },
        "block": "-> (tenant) { where(\"assets.tenant_id = ? OR assets.global = true\", tenant.id) }"
      },
      {
        "name": "by_enterprise",
        "opts": {
        },
        "block": "-> (enterprise) { where(enterprise_id: enterprise.nil? ? -1 : enterprise.id) }"
      }
    ]
  },
  {
    "class_name": "BackgroundJob",
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      },
      {
        "name": "user",
        "opts": {
        },
        "block": null
      }
    ]
  },
  {
    "class_name": "BackgroundJobResult",
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      },
      {
        "name": "user",
        "opts": {
        },
        "block": null
      }
    ]
  },
  {
    "class_name": "Backup",
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
          "inverse_of": "backups"
        },
        "block": null
      }
    ],
    "validates": [
      {
        "name": "tenant",
        "opts": {
          "presence": {
            "message": "must exist"
          }
        }
      }
    ]
  },
  {
    "class_name": "Bookmark",
    "belongs_to": [
      {
        "name": "user",
        "opts": {
        },
        "block": null
      },
      {
        "name": "context",
        "opts": {
          "polymorphic": true
        },
        "block": null
      }
    ],
    "custom": {
      "validates_uniqueness_of": {
        "name": "user_id",
        "opts": {
          "scope": [
            "context_type",
            "context_id"
          ]
        }
      }
    },
    "scopes": [
      {
        "name": "for_user",
        "opts": {
        },
        "block": "-> (user) { where(user_id: user.id) }"
      }
    ]
  },
  {
    "class_name": "Budget",
    "belongs_to": [
      {
        "name": "tenant",
        "opts": {
        },
        "block": null
      }
    ],
    "validates": [
      {
        "name": "tenant",
        "opts": {
          "presence": {
            "message": "must exist"
          }
        }
      }
    ],
    "has_many": [
      {
        "name": "budget_months",
        "opts": {
          "dependent": "destroy"
        },
        "block": null
      }
    ],
    "default_scope": {
      "on": "create",
      "block": null
    },
    "validate": [
      {
        "names": [
          "ensure_valid_financial_year"
        ],
        "opts": {
          "on": "create"
        },
        "block": null
      }
    ]
  }
]